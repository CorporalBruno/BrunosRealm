armorset:
  type: command
  name: armorset
  usage: "/armorset [ArmorSetName]"
  description: Saves armor as a set.
  debug: false
  aliases: 
  - setarmor
  - savearmor
  permission: bruno.president
  permission message: <&5>Zeus<&7>:<&3> Talk to the boss, you can't use this command.
  script:
    - if <context.args.size> == 1 {
      - flag server armorset_<c.args.get[1]>:<player.equipment>
      - wait 1t
      - narrate "<&5>Zeus<&7>:<&3> Armor set <&6><c.args.space_separated><&3> saved."
      } else {
      - narrate "<&5>Zeus<&7>:<&3> You have to declare a valid Armor Set Name. For instance: <&6>BronzeHarness"
      }
armorswitch:
  type: command
  name: armorswitch
  usage: "/armorswitch [ArmorSetName]"
  description: Switches your armor to the set you name.
  debug: false
  aliases: 
  - switcharmor
  - loadarmor
  permission: bruno.gms
  permission message: <&5>Zeus<&7>:<&3> Talk to the boss, you can't use this command.
  script:
    - if !<player.equipment.contains[i@air]> {
	  - narrate "<&5>Zeus<&7>:<&3> You must remove all armor to use this command! Try <&6>/StoreArmor"
      - determine cancelled
	  } else {
      - if <c.args.size> == 1 {
        - if <server.has_flag[armorset_<c.args.get[1]>]> && <player.has_flag[storagearmorset_<c.args.get[1]>]> && <player.has_flag[ownsarmorset_<c.args.get[1]>]> {
          - adjust <player> 'equipment:<server.flag[armorset_<c.args.space_separated>]>'
          - flag <player> 'storagearmorset_<c.args.get[1]>:!'
          - narrate "<&5>Zeus<&7>:<&3> Armor switched, you are now wearing the <&6><c.args.space_separated><&3> set. You look fabulous!"
          } else {
          - narrate "<&5>Zeus<&7>:<&3> The armor set <&6><c.args.get[1]><&3> doesn't exist or you haven't found all the pieces yet."
          - determine cancelled
          }
        } else {
        - narrate "<&5>Zeus<&7>:<&3> You have to declare a valid Armor Set Name. For instance: <&6>BronzeHarness"
        - determine cancelled
        }
      }
storearmor:
  type: command
  name: storearmor
  usage: "/storearmor"
  description: Stores armor as long as its a full set.
  debug: false
  permission: bruno.gms
  permission message: <&5>Zeus<&7>:<&3> Talk to the boss, you can't use this command.
  script:
    - if <context.args.size> == 0 {
      - define ArmorSetName "<player.equipment.chestplate.lore.after[Set<&7>:<&6><&sp>].before[|<&2>Armor]>"
      - if <player.equipment> == <server.flag[armorset_%ArmorSetName%]> { 
        - if <player.has_flag[ownsarmorset_%ArmorSetName%]> {
          - adjust <player> 'equipment:<server.flag[armorset_air]>'
          - flag <player> 'storagearmorset_%ArmorSetName%'
          - narrate "<&5>Zeus<&7>:<&3> Armor Set <&6>%ArmorSetName%<&3> stored, don't forget to put on some clothes."
          } else {
          - flag <player> ownsarmorset_%ArmorSetName%
          - adjust <player> 'equipment:<server.flag[armorset_air]>'
          - flag <player> 'storagearmorset_%ArmorSetName%'
          - narrate "<&5>Zeus<&7>:<&3> Armor Set <&6>%ArmorSetName%<&3> stored, don't forget to put on some clothes."
          }
        } else {
        - narrate "<&5>Zeus<&7>:<&3> The equipment you are wearing is not a complete set."
        - determine cancelled
        }
      } else {
      - narrate "<&5>Zeus<&7>:<&3> Just type: <&6>/StoreArmor"
      - determine cancelled
      }
armor_equip_listen:
  type: world
  debug: false
  events:
    on player equips armor:
    - define ArmorSetName <context.armor.lore.after[Set<&7>:<&6><&sp>].before[|<&2>Armor]>
    - if <player.equipment> == <server.flag[armorset_%ArmorSetName%]> { 
      - narrate "<&5>Zeus<&7>:<&3> Full armor set <&6>%ArmorSetName%<&3> equipped!"
      - if !<player.has_flag[ownsarmorset_%ArmorSetName%]> {
        - flag <player> ownsarmorset_%ArmorSetName%
        }
      }